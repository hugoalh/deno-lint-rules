import {
	NodeMemberExpressionMatcher,
	type RuleData
} from "../_utility.ts";
const mems: readonly NodeMemberExpressionMatcher[] = [
	"AbortController",
	"AbortSignal",
	"addEventListener",
	"AggregateError",
	"alert",
	"Array",
	"ArrayBuffer",
	"AsyncDisposableStack",
	"AsyncFunction",
	"AsyncGenerator",
	"AsyncGeneratorFunction",
	"AsyncIterator",
	"atob",
	"Atomics",
	"BigInt",
	"BigInt64Array",
	"BigUint64Array",
	"Blob",
	"Boolean",
	"BroadcastChannel",
	"btoa",
	"ByteLengthQueuingStrategy",
	"Cache",
	"caches",
	"CacheStorage",
	"cancelAnimationFrame",
	"CanvasGradient",
	"CanvasPattern",
	"CanvasRenderingContext2D",
	"CharacterData",
	"clearInterval",
	"clearTimeout",
	"Clipboard",
	"ClipboardEvent",
	"close",
	"CloseEvent",
	"Comment",
	"CompressionStream",
	"confirm",
	"console",
	"CountQueuingStrategy",
	"createImageBitmap",
	"crossOriginIsolated",
	"crypto",
	"Crypto",
	"CryptoKey",
	"CustomElementRegistry",
	"CustomEvent",
	"DataTransfer",
	"DataTransferItem",
	"DataTransferItemList",
	"DataView",
	"Date",
	"decodeURI",
	"decodeURIComponent",
	"DedicatedWorkerGlobalScope",
	"Deno",
	"dispatchEvent",
	"DisposableStack",
	"Document",
	"DocumentFragment",
	"DocumentType",
	"DOMException",
	"DOMMatrix",
	"DOMMatrixReadOnly",
	"DOMParser",
	"DOMPoint",
	"DOMPointReadOnly",
	"DOMQuad",
	"DOMRect",
	"DOMRectList",
	"DOMRectReadOnly",
	"DOMStringList",
	"DOMTokenList",
	"Element",
	"encodeURI",
	"encodeURIComponent",
	"Error",
	"ErrorEvent",
	"eval",
	"EvalError",
	"Event",
	"EventSource",
	"EventTarget",
	"fetch",
	"File",
	"FileList",
	"FileReader",
	"finalizationRegistry",
	"FinalizationRegistry",
	"Float16Array",
	"Float32Array",
	"Float64Array",
	"FormData",
	"Function",
	"Headers",
	"history",
	"IDBFactory",
	"IDBIndex",
	"IDBKeyRange",
	"IDBObjectStore",
	"IDBOpenDBRequest",
	"IDBRequest",
	"IDBTransaction",
	"IDBVersionChangeEvent",
	"ImageBitmap",
	"ImageBitmapRenderingContext",
	"ImageData",
	"indexedDB",
	"Infinity",
	"Int16Array",
	"Int32Array",
	"Int8Array",
	"InternalError",
	"Intl",
	"isFinite",
	"isNaN",
	"isSecureContext",
	"Iterator",
	"JSON",
	"location",
	"Map",
	"Math",
	"MediaCapabilities",
	"MessageChannel",
	"MessageEvent",
	"MessagePort",
	"name",
	"NaN",
	"navigator",
	"NetworkInformation",
	"Notification",
	"Number",
	"Object",
	"offscreenCanvas",
	"onerror",
	"onlanguagechange",
	"onmessage",
	"onmessageerror",
	"onoffline",
	"ononline",
	"onrejectionhandled",
	"onunhandledrejection",
	"origin",
	"parseFloat",
	"parseInt",
	"Path2D",
	"performance",
	"Performance",
	"PerformanceEntry",
	"PerformanceMark",
	"PerformanceMeasure",
	"PerformanceObserver",
	"PerformanceObserverEntryList",
	"PerformanceResourceTiming",
	"PerformanceServerTiming",
	"Permissions",
	"PermissionStatus",
	"postMessage",
	"ProgressEvent",
	"Promise",
	"PromiseRejectionEvent",
	"prompt",
	"Proxy",
	"PushManager",
	"PushSubscription",
	"PushSubscriptionOptions",
	"queueMicrotask",
	"RangeError",
	"ReadableStream",
	"ReadableStreamDefaultController",
	"ReadableStreamDefaultReader",
	"ReferenceError",
	"Reflect",
	"RegExp",
	"removeEventListener",
	"Request",
	"requestAnimationFrame",
	"Response",
	"screen",
	"SecurityPolicyViolationEvent",
	"ServiceWorker",
	"ServiceWorkerContainer",
	"ServiceWorkerRegistration",
	"Set",
	"setInterval",
	"setTimeout",
	"ShadowRoot",
	"SharedArrayBuffer",
	"StorageManager",
	"String",
	"structuredClone",
	"SubtleCrypto",
	"SuppressedError",
	"Symbol",
	"SyntaxError",
	"Temporal",
	"TextDecoder",
	"TextDecoderStream",
	"TextEncoder",
	"TextEncoderStream",
	"TextMetrics",
	"TextTrack",
	"TextTrackCue",
	"TextTrackList",
	"TimeRanges",
	"TransformStream",
	"TransformStreamDefaultController",
	"TypedArray",
	"TypeError",
	"Uint16Array",
	"Uint32Array",
	"Uint8Array",
	"Uint8ClampedArray",
	"undefined",
	"URIError",
	"URL",
	"URLSearchParams",
	"WeakMap",
	"WeakRef",
	"WeakSet",
	"WebAssembly",
	"WebGL2RenderingContext",
	"WebGLActiveInfo",
	"WebGLBuffer",
	"WebGLContextEvent",
	"WebGLFramebuffer",
	"WebGLProgram",
	"WebGLQuery",
	"WebGLRenderbuffer",
	"WebGLRenderingContext",
	"WebGLSampler",
	"WebGLShader",
	"WebGLShaderPrecisionFormat",
	"WebGLSync",
	"WebGLTexture",
	"WebGLTransformFeedback",
	"WebGLUniformLocation",
	"WebGLVertexArrayObject",
	"WebSocket",
	"Worker",
	"WritableStream",
	"WritableStreamDefaultController",
	"WritableStreamDefaultWriter",
	"XMLDocument",
	"XMLHttpRequest",
	"XMLHttpRequestEventTarget",
	"XMLHttpRequestUpload",
	"XPathEvaluator",
	"XPathExpression",
	"XPathResult"
].map((value: string): NodeMemberExpressionMatcher => {
	return new NodeMemberExpressionMatcher([value], true);
});
export const ruleData: RuleData = {
	identifier: "no-useless-global-prefix",
	querier(): Deno.lint.Rule {
		return {
			create(context: Deno.lint.RuleContext): Deno.lint.LintVisitor {
				return {
					MemberExpression(node: Deno.lint.MemberExpression): void {
						if (!node.computed && !node.optional && mems.some((mem: NodeMemberExpressionMatcher): boolean => {
							return mem.test(node);
						})) {
							const replacementText: string = context.sourceCode.getText(node.property);
							context.report({
								node,
								message: `Use via the globals object(s) is forbidden.`,
								hint: `Do you mean \`${replacementText}\`?`,
								fix(fixer: Deno.lint.Fixer): Deno.lint.Fix | Iterable<Deno.lint.Fix> {
									return fixer.replaceText(node, replacementText);
								}
							});
						}
					}
				};
			}
		};
	}
};
